
    WITH
      toDateTime('1697155380') AS startDate,
      toDateTime('1697760180') AS endDate
    SELECT
      clientName,
      clientVersion,
      groupArray((latestOperationHash, operationName, requestCount)) AS operations
      FROM (
          SELECT
              ClientName as clientName,
              ClientVersion as clientVersion,
              OperationName as operationName,
              argMax(OperationHash, Timestamp) as latestOperationHash,
              sum(Count) as requestCount
          FROM cosmo.gql_metrics_schema_usage
          WHERE Timestamp >= startDate AND Timestamp <= endDate
              AND hasAny(TypeNames, ['Query'])
              AND endsWith(Path, ['employees'])
              AND FederatedGraphID = 'b56a222d-b855-452c-9ebe-3aa259e7a100'
              AND OrganizationID = '14f99969-1d8e-4530-8992-cd67c4b4c7fc'
          GROUP BY clientName, clientVersion, operationName
      )
    GROUP BY clientName, clientVersion
    ORDER BY clientName, clientVersion
    